# üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

## üìã –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (Sign Up)
- **–§–∞–π–ª**: [app/register/page.tsx](app/register/page.tsx)
- **API**: [app/api/auth/register/route.ts](app/api/auth/register/route.ts)
- üîí –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å **bcryptjs** (10 —Ä–∞—É–Ω–¥–æ–≤)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email, –ø–∞—Ä–æ–ª—è, –∏–º–µ–Ω–∏ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- ‚úÖ –ü–æ–ª–µ `phone` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å Prisma
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π `TestAccess` –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –ï—Å–ª–∏ email —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `ADMIN_EMAIL` ‚Äî —Ä–æ–ª—å `admin` –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è JWT —Ç–æ–∫–µ–Ω

### ‚úÖ –í—Ö–æ–¥ (Sign In)
- **–§–∞–π–ª**: [app/login/page.tsx](app/login/page.tsx)
- **API**: [app/api/auth/login/route.ts](app/api/auth/login/route.ts)
- üîë –ù–∞—Å—Ç–æ—è—â–∏–π **JWT —Ç–æ–∫–µ–Ω** (—Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è 7 –¥–Ω–µ–π)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è —Å **bcrypt.compare()**
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage

### ‚úÖ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (Dashboard)
- **–§–∞–π–ª**: [app/dashboard/page.tsx](app/dashboard/page.tsx)
- üõ°Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ API endpoint [app/api/auth/me/route.ts](app/api/auth/me/route.ts)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –§—É–Ω–∫—Ü–∏—è **logout** (—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞

### ‚úÖ –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è (Forgot / Reset Password)
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞**: [app/reset-password/page.tsx](app/reset-password/page.tsx)
- **API**: `POST /api/auth/forgot-password` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω —Å–±—Ä–æ—Å–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ (nodemailer)
- **API**: `POST /api/auth/reset-password` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–∫–µ–Ω + –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å, —Ö–µ—à–∏—Ä—É–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç
- ‚úÖ –¢–æ–∫–µ–Ω —Å–±—Ä–æ—Å–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç 1 —á–∞—Å
- ‚úÖ Email –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚Äî –æ—Ç–≤–µ—Ç –≤—Å–µ–≥–¥–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π (–∑–∞—â–∏—Ç–∞ –æ—Ç enumeration)

---

## üîÑ –ü–æ—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```
1. –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø
   ‚îî‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É ‚Üí –ü–∞—Ä–æ–ª—å —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

2. –í–•–û–î
   ‚îî‚îÄ Email + –ø–∞—Ä–æ–ª—å ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å bcrypt ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JWT ‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω

3. –°–û–•–†–ê–ù–ï–ù–ò–ï –¢–û–ö–ï–ù–ê
   ‚îî‚îÄ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage –±—Ä–∞—É–∑–µ—Ä–∞

4. –î–û–°–¢–£–ü –ö DASHBOARD
   ‚îî‚îÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –≤ API ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

5. LOGOUT
   ‚îî‚îÄ –£–¥–∞–ª—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –∏–∑ localStorage ‚Üí –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
```

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcryptjs):
```typescript
import bcrypt from 'bcryptjs'

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
const hashedPassword = await bcrypt.hash(password, 10)

// –í—Ö–æ–¥
const isValid = await bcrypt.compare(password, user.password)
```

### JWT —Ç–æ–∫–µ–Ω:
```typescript
import jwt from 'jsonwebtoken'

// –°–æ–∑–¥–∞–Ω–∏–µ (lib/jwt.ts ‚Äî generateToken)
const token = jwt.sign(
  { userId, email, role }, // payload –≤–∫–ª—é—á–∞–µ—Ç —Ä–æ–ª—å
  process.env.JWT_SECRET,
  { expiresIn: '7d' }
)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ (lib/jwt.ts ‚Äî verifyToken)
const decoded = jwt.verify(token, JWT_SECRET)
// decoded: { userId: number, email: string, role: string }
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:
```typescript
// app/dashboard/page.tsx
const response = await fetch('/api/auth/me', {
  headers: {
    'Authorization': `Bearer ${token}`,
  },
})
```

---

## üìù API endpoints:

### 1. POST /api/auth/register
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "fullName": "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
    "email": "ivan@example.com",
    "password": "password123",
    "birthDate": "2005-01-15",
    "phone": "+380991112233"
  }'
```

**Response:**
```json
{
  "success": true,
  "message": "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π",
  "user": {
    "id": 1,
    "fullName": "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
    "email": "ivan@example.com"
  }
}
```

### 2. POST /api/auth/login
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "ivan@example.com",
    "password": "password123"
  }'
```

**Response:**
```json
{
  "success": true,
  "message": "–í—Ö—ñ–¥ —É—Å–ø—ñ—à–Ω–∏–π",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "fullName": "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
    "email": "ivan@example.com"
  }
}
```

### 3. GET /api/auth/me
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)
```bash
curl http://localhost:3000/api/auth/me \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**Response:**
```json
{
  "success": true,
  "user": {
    "id": 1,
    "fullName": "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
    "email": "ivan@example.com",
    "phone": "+380991112233",
    "birthDate": "2005-01-15T00:00:00.000Z",
    "role": "user",
    "createdAt": "2026-02-10T12:00:00.000Z"
  }
}
```

### 4. POST /api/auth/forgot-password
–ó–∞–ø—Ä–æ—Å —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ —Å–æ —Å—Å—ã–ª–∫–æ–π
```bash
curl -X POST http://localhost:3000/api/auth/forgot-password \
  -H "Content-Type: application/json" \
  -d '{"email": "ivan@example.com"}'
```

### 5. POST /api/auth/reset-password
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è –ø–æ —Ç–æ–∫–µ–Ω—É –∏–∑ –ø–∏—Å—å–º–∞
```bash
curl -X POST http://localhost:3000/api/auth/reset-password \
  -H "Content-Type: application/json" \
  -d '{"token": "<reset_token>", "password": "newpassword123"}'
```

---

## üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# JWT —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (–º–µ–Ω—è–π—Ç–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!)
JWT_SECRET="your-secret-key-change-this-in-production"

# Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ‚Äî –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å —ç—Ç–∏–º email —Ä–æ–ª—å –±—É–¥–µ—Ç 'admin'
ADMIN_EMAIL="admin@example.com"

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
# –õ–æ–∫–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite (—Ñ–∞–π–ª –≤ prisma/prisma/dev.db)
DATABASE_URL="file:./prisma/dev.db"
```

---

## ‚ö†Ô∏è –°–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö:

| –°—Ç–∞—Ç—É—Å | –°–æ–æ–±—â–µ–Ω–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|-----------|---------|
| 400 | –í—Å—ñ –ø–æ–ª—è –æ–±–æ–≤—è–∑–∫–æ–≤—ñ | –ù–µ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã |
| 400 | –ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤ | –ü–∞—Ä–æ–ª—å –∫–æ—Ä–æ—á–µ 6 —Å–∏–º–≤–æ–ª–æ–≤ |
| 400 | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–æ—é email –≤–∂–µ —ñ—Å–Ω—É—î | Email —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| 401 | –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å | –ü–∞—Ä–æ–ª—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π |
| 401 | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| 401 | –ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π —Ç–æ–∫–µ–Ω | –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω |
| 500 | –ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –û—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä**: http://localhost:3000

2. **–¢–µ—Å—Ç 1 - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
   - –ù–∞–∂–º–∏—Ç–µ "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è
   - –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä–æ–ª–µ –∫–æ—Ä–æ—á–µ 6 —Å–∏–º–≤–æ–ª–æ–≤
   - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login

3. **–¢–µ—Å—Ç 2 - –í—Ö–æ–¥:**
   - –í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å
   - –î–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
   - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /dashboard

4. **–¢–µ—Å—Ç 3 - Dashboard:**
   - –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤–∏–¥–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
   - –ù–∞–∂–º–∏—Ç–µ "–í–∏–π—Ç–∏"
   - –î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
   - –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–∫—Ä—ã—Ç—å /dashboard –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è (bcrypt —Å 10 —Ä–∞—É–Ω–¥–∞–º–∏)  
‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è  
‚úÖ –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –Ω–∞ HttpOnly cookies)  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º endpoint'–∞–º  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ login –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫  

---

## üöÄ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. üîí –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ HttpOnly cookies (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ —á–µ–º localStorage)
2. üì± –î–æ–±–∞–≤–∏—Ç—å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è" –æ–ø—Ü–∏—é
3. üë§ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. üîÑ Refresh-—Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–¥–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏

---

**‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

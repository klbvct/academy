# üóÑÔ∏è Prisma ORM - –ë–∞–∑–∞ –î–∞–Ω–∏—Ö

## üìä –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ:

‚úÖ **Prisma Client** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚úÖ **SQLite –ë–î** - —Ñ–∞–π–ª `prisma/dev.db` —Å –≤—Å–µ–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏–∏** - –ø–∞–ø–∫–∞ `prisma/migrations` —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚úÖ **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –æ–±–Ω–æ–≤–ª–µ–Ω—ã endpoints –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü –≤ –ë–î:

### Users (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
```
- id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- fullName: –ø–æ–ª–Ω–æ–µ –∏–º—è
- email: —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ (—É–Ω–∏–∫–∞–ª—å–Ω–∞—è)
- password: –ø–∞—Ä–æ–ª—å (–≤ –ø–∞–º—è—Ç–∏, –ë–ï–ó —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bcrypt)
- birthDate: –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
- createdAt: –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
- updatedAt: –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- isActive: —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞
```

### Tests (–¢–µ—Å—Ç—ã)
```
- id: ID —Ç–µ—Å—Ç–∞
- title: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞
- description: –æ–ø–∏—Å–∞–Ω–∏–µ
- category: –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- price: —Ü–µ–Ω–∞ (–¥–ª—è LiqPay)
- duration: –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–Ω—É—Ç–∞—Ö
- questionsCount: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
```

### Questions (–í–æ–ø—Ä–æ—Å—ã)
```
- id: ID –≤–æ–ø—Ä–æ—Å–∞
- testId: —Å–≤—è–∑—å —Å —Ç–µ—Å—Ç–æ–º
- text: —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
- questionOrder: –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
```

### Payments (–ü–ª–∞—Ç–µ–∂–∏ - –¥–ª—è LiqPay)
```
- id: ID –ø–ª–∞—Ç–µ–∂–∞
- userId: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- orderId: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–∫–∞–∑–∞
- amount: —Å—É–º–º–∞
- status: —Å—Ç–∞—Ç—É—Å (pending, success, failed)
- liqpayTransactionId: ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ LiqPay
```

### TestAccess (–î–æ—Å—Ç—É–ø –∫ —Ç–µ—Å—Ç–∞–º)
```
- id: ID –¥–æ—Å—Ç—É–ø–∞
- userId: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- testId: —Ç–µ—Å—Ç
- paymentId: —Å–≤—è–∑—å —Å –ø–ª–∞—Ç–µ–∂–æ–º
- hasAccess: –µ—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø
- accessGrantedAt: –∫–æ–≥–¥–∞ –≤—ã–¥–∞–Ω –¥–æ—Å—Ç—É–ø
```

### TestResult (–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤)
```
- id: ID —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- userId: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- testId: —Ç–µ—Å—Ç
- scores: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (JSON)
- recommendations: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (JSON)
- completedAt: –∫–æ–≥–¥–∞ –ø—Ä–æ–π–¥–µ–Ω
```

---

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Prisma:

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
npx prisma migrate dev --name –Ω–∞–∑–≤–∞–Ω–∏–µ_–º–∏–≥—Ä–∞—Ü–∏–∏
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ö–µ–º—ã –≤ Prisma Studio (UI –¥–ª—è –ë–î):
```bash
npx prisma studio
```

### –°–±—Ä–æ—Å –ë–î (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ):
```bash
npx prisma migrate reset
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:
```bash
npx prisma migrate deploy
```

---

## üíª –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å Prisma –≤ –∫–æ–¥–µ:

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```typescript
import { prisma } from '@/lib/prisma'

const user = await prisma.user.create({
  data: {
    fullName: '–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ',
    email: 'ivan@example.com',
    password: '123456',
    birthDate: new Date('2005-01-15'),
  },
})
```

### –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```typescript
const user = await prisma.user.findUnique({
  where: { email: 'ivan@example.com' },
})
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```typescript
const updatedUser = await prisma.user.update({
  where: { id: 1 },
  data: { fullName: '–ù–æ–≤–æ–µ –∏–º—è' },
})
```

### –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```typescript
await prisma.user.delete({
  where: { id: 1 },
})
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:
```typescript
const tests = await prisma.test.findMany({
  include: { questions: true },
})
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–•–µ—à–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bcryptjs`
```bash
npm install bcryptjs
```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL**: –≤–º–µ—Å—Ç–æ SQLite
```env
DATABASE_URL="postgresql://user:password@localhost:5432/career_path"
```

3. **–í–∫–ª—é—á–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `zod` –∏–ª–∏ `joi`

4. **–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

```
prisma/
‚îú‚îÄ‚îÄ schema.prisma      # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î
‚îú‚îÄ‚îÄ dev.db            # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ migrations/       # –ò—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
  
lib/
‚îî‚îÄ‚îÄ prisma.ts         # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Prisma Client

.env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ **PostgreSQL + Prisma** - –ì–û–¢–û–í–û
2. üìù **–°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è —Ç–µ—Å—Ç–æ–≤**
3. üí≥ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å LiqPay –ø–ª–∞—Ç–µ–∂–∏**
4. üìä **–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
5. üîê **–î–æ–±–∞–≤–∏—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π**

---

**–¢–µ–ø–µ—Ä—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î!** üéâ
